<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Reference - Strigo</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        pre {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }

        code {
            font-family: 'Courier New', Courier, monospace;
        }

        .method {
            color: #2c5282;
            font-weight: bold;
        }

        .type {
            color: #805ad5;
        }
    </style>
</head>

<body>
    <h1>Strigo API Reference</h1>

    <h2>Packages</h2>

    <h3>ratelimiter</h3>
    <p>Package that provides core rate limiting functionality.</p>

    <h4>Manager</h4>
    <pre><code>type Manager interface {
    Close() error
    IsAllowed(pattern string, strategy config.Strategy, period duration.Period, limit int64) (bool, error)
}</code></pre>

    <h5>NewManager</h5>
    <pre><code>func NewManager(storageType limiter.StorageType, connectionString string) Manager</code></pre>
    <p>Parameters:</p>
    <ul>
        <li><code>storageType</code>: <code>limiter.Redis</code> or <code>limiter.Memcached</code></li>
        <li><code>connectionString</code>: Connection information for the storage server</li>
    </ul>

    <h3>middleware/fiber</h3>
    <p>Middleware implementation for the Fiber web framework.</p>

    <h4>RateLimitHandler</h4>
    <pre><code>func RateLimitHandler(
    manager ratelimiter.Manager,
    configProvider func(*fiber.Ctx) []limiter.RuleConfig
) fiber.Handler</code></pre>

    <p>Parameters:</p>
    <ul>
        <li><code>manager</code>: Rate limiting manager</li>
        <li><code>configProvider</code>: Function that returns rate limit rules for each request</li>
    </ul>

    <h3>pkg/limiter</h3>
    <p>Package containing basic structures for rate limiting.</p>

    <h4>RuleConfig</h4>
    <pre><code>type RuleConfig struct {
    Pattern  string
    Strategy config.Strategy
    Period   duration.Period
    Limit    int64
}</code></pre>

    <h4>StorageType</h4>
    <pre><code>type StorageType int

const (
    Redis StorageType = iota
    Memcached
)</code></pre>

    <h3>pkg/duration</h3>
    <p>Constants for time intervals.</p>

    <pre><code>const (
    MINUTELY Period = iota
    HOURLY
    DAILY
    WEEKLY
    MONTHLY
)</code></pre>

    <h3>config</h3>
    <p>Configuration constants.</p>

    <pre><code>const (
    TokenBucket Strategy = iota
    // Other strategies to be added in the future
)</code></pre>

    <h2>Error Codes</h2>
    <p>HTTP status codes returned when rate limit is exceeded:</p>
    <ul>
        <li><code>429 Too Many Requests</code>: Rate limit exceeded</li>
        <li><code>500 Internal Server Error</code>: Rate limiter service unavailable</li>
    </ul>

    <h2>Response Headers</h2>
    <p>HTTP headers returned related to rate limiting:</p>
    <ul>
        <li><code>X-RateLimit-Limit</code>: Total number of allowed requests</li>
        <li><code>X-RateLimit-Remaining</code>: Number of remaining requests</li>
        <li><code>X-RateLimit-Reset</code>: UNIX timestamp when the limit will reset</li>
    </ul>

    <nav>
        <a href="index.html">Home</a> |
        <a href="getting-started.html">Getting Started Guide</a> |
        <a href="advanced.html">Advanced Guide</a>
    </nav>
</body>

</html>